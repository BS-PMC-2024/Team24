<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SRS</title>

    <!-- Load jQuery from a CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Materialize CSS and FontAwesome from a CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <!-- ////////////////////////////////////////////////////////// -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link
      rel="stylesheet"
      href="https://www.w3schools.com/lib/w3-theme-black.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <style>
      body,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: "Raleway", sans-serif;
      }

      body,
      html {
        height: 100%;
        line-height: 1.8;
      }
      .pad-bot-10 {
        padding-bottom: 20px !important;
      }
      .container {
        margin-top: 60px;
      }
      .card-panel {
        margin-left: auto;
        margin-right: auto;
        width: 95%;
      }
      .w3-bar .w3-button {
        padding: 16px;
      }
      .input-field {
        margin-bottom: 20px;
      }
      /* Custom button styles */
      .btn-custom {
        background-color: orange; /* Orange color */
        color: #fff; /* Text color */
        border-radius: 30px; /* Rounded buttons */
        font-family: "Comic Sans MS", cursive, sans-serif; /* Rounded font for buttons */
      }
      .btn-custom:hover {
        background-color: darkorange; /* Darker orange on hover */
        color: #fff; /* Text color on hover */
      }
      textarea.materialize-textarea {
        border-radius: 15px; /* More square textarea */
      }
      .orange-text {
        color: orange; /* Set text color to orange */
      }
      .page {
        display: none; /* Hide all pages by default */
      }
      /* Tooltip styles */
      .support-icon {
        position: fixed;
        bottom: 20px;
        right: 20px;
        cursor: pointer;
      }
      .tooltip {
        visibility: hidden;
        width: 100px;
        background-color: #555;
        color: #fff;
        text-align: center;
        border-radius: 5px;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        bottom: 125%; /* Position above the icon */
        right: 50%; /* Center the tooltip */
        margin-right: -50%; /* Offset the tooltip */
        opacity: 0;
        transition: opacity 0.3s;
      }
      .support-icon:hover .tooltip {
        visibility: visible;
        opacity: 1;
      }
      /* Request received popup styles */
      .request-received-popup {
        visibility: hidden; /* Initially hidden */
        opacity: 0; /* Start as invisible */
        transition: visibility 0s 0.3s, opacity 0.3s linear; /* Transition for visibility and opacity */
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        border: 2px solid orange;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 9999;
        text-align: center;
      }
      #supportFileLabel {
        margin-bottom: 20px; /* Adjust the value as needed */
      }

      /* Custom smaller button styles */
      .btn-custom-small {
        background-color: transparent; /* Transparent background */
        color: orange; /* Orange icon color */
        border: 1px solid orange; /* Thin border */
        padding: 4px 8px; /* Smaller padding */
        font-size: 0.8em; /* Smaller font size */
        border-radius: 50%; /* Circular button */
        display: inline-block;
        transition: all 0.3s ease; /* Smooth transition */
      }

      .btn-custom-small:hover {
        background-color: orange; /* Orange background on hover */
        color: white; /* White icon color on hover */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Subtle shadow on hover */
        transform: scale(1.1); /* Slightly larger on hover */
      }
    </style>
  </head>
  <body>
    <!-- Navbar (sit on top) -->
    <div class="w3-top">
      <div class="w3-bar w3-white w3-card" id="myNavbar">
        <a href="{% url 'hometest' %}" class="w3-bar-item w3-button w3-wide"
          >ReqGenious</a
        >
        <!-- Right-sided navbar links -->
        <div class="w3-right w3-hide-small">
          <a href="{% url 'login' %}" class="w3-bar-item w3-button"
            ><i class="fa fa-user"></i> HOME</a
          >
          <a href="{% url 'feedback' %}" class="w3-bar-item w3-button"
            ><i class="fa fa-user"></i> FEEDBACK</a
          >
        </div>
        <!-- Hide right-floated links on small screens and replace them with a menu icon -->
        <a
          href="javascript:void(0)"
          class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium"
          onclick="w3_open()"
        >
          <i class="fa fa-bars"></i>
        </a>
      </div>
    </div>

    <main>
      <div class="container">
        <div class="row">
          <div class="section">
            <h1 class="center-align orange-text">SRS</h1>
            <h8 class="center-align grey-text"
              >Please fill in the following fields, and by clicking 'Submit',
              you will receive professional AI feedback</h8
            >
            <!-- Modal for Page 1 Description (Purpose) -->
            <div id="modal1" class="modal">
              <div class="modal-content">
                <h4>Purpose</h4>
                <p>
                  This section should describe the purpose of the system or
                  document.
                </p>
              </div>
              <div class="modal-footer">
                <a
                  href="#!"
                  class="modal-close btn btn-custom waves-effect waves-light"
                  >Close</a
                >
              </div>
            </div>

            <!-- Modal for Page 2 Description (Scope) -->
            <div id="modal2" class="modal">
              <div class="modal-content">
                <h4>Scope</h4>
                <p>
                  This section should outline the scope of the project,
                  including the features and functionalities.
                </p>
              </div>
              <div class="modal-footer">
                <a
                  href="#!"
                  class="modal-close btn btn-custom waves-effect waves-light"
                  >Close</a
                >
              </div>
            </div>

            <!-- Modal for Page 3 Description (Definitions) -->
            <div id="modal3" class="modal">
              <div class="modal-content">
                <h4>Definitions</h4>
                <p>
                  This section should define any terms, acronyms, and
                  abbreviations used in the document.
                </p>
              </div>
              <div class="modal-footer">
                <a
                  href="#!"
                  class="modal-close btn btn-custom waves-effect waves-light"
                  >Close</a
                >
              </div>
            </div>

            <!-- Modal for Page 4 Description (References) -->
            <div id="modal4" class="modal">
              <div class="modal-content">
                <h4>References</h4>
                <p>
                  This section should list any documents or sources referenced
                  in the SRS.
                </p>
              </div>
              <div class="modal-footer">
                <a
                  href="#!"
                  class="modal-close btn btn-custom waves-effect waves-light"
                  >Close</a
                >
              </div>
            </div>

            <!-- Modal for Page 5 Description (Overview) -->
            <div id="modal5" class="modal">
              <div class="modal-content">
                <h4>Overview</h4>
                <p>
                  This section should provide a high-level overview of the
                  system and its major components.
                </p>
              </div>
              <div class="modal-footer">
                <a
                  href="#!"
                  class="modal-close btn btn-custom waves-effect waves-light"
                  >Close</a
                >
              </div>
            </div>
            <div class="section center-align">
              <a
                href="javascript:void(0)"
                class="btn btn-custom waves-effect waves-light tooltipped"
                data-tooltip="1. Purpose"
                onclick="showPage(1)"
                >1</a
              >
              <a
                href="#modal1"
                class="btn-custom-small waves-effect waves-light modal-trigger"
              >
                <i class="fa fa-info-circle"></i>
              </a>

              <a
                href="javascript:void(0)"
                class="btn btn-custom waves-effect waves-light tooltipped"
                data-tooltip="2. Scope"
                onclick="showPage(2)"
                >2</a
              >
              <a
                href="#modal2"
                class="btn-custom-small waves-effect waves-light modal-trigger"
              >
                <i class="fa fa-info-circle"></i>
              </a>

              <a
                href="javascript:void(0)"
                class="btn btn-custom waves-effect waves-light tooltipped"
                data-tooltip="3. Definitions"
                onclick="showPage(3)"
                >3</a
              >
              <a
                href="#modal3"
                class="btn-custom-small waves-effect waves-light modal-trigger"
              >
                <i class="fa fa-info-circle"></i>
              </a>

              <a
                href="javascript:void(0)"
                class="btn btn-custom waves-effect waves-light tooltipped"
                data-tooltip="4. References"
                onclick="showPage(4)"
                >4</a
              >
              <a
                href="#modal4"
                class="btn-custom-small waves-effect waves-light modal-trigger"
              >
                <i class="fa fa-info-circle"></i>
              </a>

              <a
                href="javascript:void(0)"
                class="btn btn-custom waves-effect waves-light tooltipped"
                data-tooltip="5. Overview"
                onclick="showPage(5)"
                >5</a
              >
              <a
                href="#modal5"
                class="btn-custom-small waves-effect waves-light modal-trigger"
              >
                <i class="fa fa-info-circle"></i>
              </a>
            </div>

            <br />
            <h8 class="center-align grey-text">Choose a field</h8>
          </div>
        </div>

        <form id="srsForm">
          {% csrf_token %}

        <!-- Page sections -->
        <div id="page1" class="page">
          <div class="row valign-wrapper">
            <div class="card-panel">
              <div class="card-content grey-text text-darken-3">
                <div class="input-field">
                  <textarea
                    id="field1"
                    class="materialize-textarea"
                    rows="4"
                  >{{ field1 }}</textarea>
                  <label for="quoteInput1">1. Purpose</label>
                </div>
                <div class="section center-align">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-custom waves-effect waves-light"
                    onclick="saveField('field1')"
                    >Save</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="page2" class="page">
          <div class="row valign-wrapper">
            <div class="card-panel">
              <div class="card-content grey-text text-darken-3">
                <div class="input-field">
                  <textarea
                    id="quoteInput2"
                    class="materialize-textarea"
                    rows="4"
                  >{{ field2 }}</textarea>
                  <label for="field2">2. Scope</label>
                </div>
                <div class="section center-align">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-custom waves-effect waves-light"
                    onclick="saveField('field2')"
                    >Save</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="page3" class="page">
          <div class="row valign-wrapper">
            <div class="card-panel">
              <div class="card-content grey-text text-darken-3">
                <div class="input-field">
                  <textarea
                    id="field3"
                    class="materialize-textarea"
                    rows="4"
                  >{{ field3 }}</textarea>
                  <label for="quoteInput3"
                    >3. Definitions, Acronyms, and Abbreviations</label
                  >
                </div>
                <div class="section center-align">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-custom waves-effect waves-light"
                    onclick="saveField('field3')"
                    >Save</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="page4" class="page">
          <div class="row valign-wrapper">
            <div class="card-panel">
              <div class="card-content grey-text text-darken-3">
                <div class="input-field">
                  <textarea
                    id="field4"
                    class="materialize-textarea"
                    rows="4"
                  >{{ field4 }}</textarea>
                  <label for="quoteInput4">4. References</label>
                </div>
                <div class="section center-align">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-custom waves-effect waves-light"
                    onclick="saveField('field4')"
                    >Save</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="page5" class="page">
          <div class="row valign-wrapper">
            <div class="card-panel">
              <div class="card-content grey-text text-darken-3">
                <div class="input-field">
                  <textarea
                    id="field5"
                    class="materialize-textarea"
                    rows="4"
                  >{{ field5 }}</textarea>
                  <label for="quoteInput5">5. Overview</label>
                </div>
                <div class="section center-align">
                  <a
                    href="javascript:void(0)"
                    class="btn btn-custom waves-effect waves-light"
                    onclick="saveField('field5')"
                    >Save</a
                  >
                  <a
                    href="javascript:void(0)"
                    class="btn btn-custom waves-effect waves-light"
                    onclick="openSupportModal()"
                    >Submit</a
                  >
                  <div class="section center-align" style="margin-top: 20px">
                    <a
                      href="javascript:void(0)"
                      class="btn btn-custom waves-effect waves-light"
                    >
                      Download
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>

      <!-- Support Center Icon with Tooltip -->
      <div class="support-icon">
        <i
          class="fas fa-headset"
          style="font-size: 30px"
          onclick="openSupportModal()"
        ></i>
        <span class="tooltip">Technical Support</span>
      </div>

      <!-- Support Request Modal -->
     <!-- Support Request Modal -->
     <div id="supportModal" class="modal">
      <form id="supportForm" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="modal-content">
              <h4>Support Request</h4>
              <div class="input-field">
                  <input type="text" id="supportName" name="username" required />
                  <label for="supportName">Your Name <span style="color: red">*</span></label>
              </div>
              <div class="input-field">
                  <input type="email" id="supportEmail" name="email" required />
                  <label for="supportEmail">Your Email <span style="color: red">*</span></label>
              </div>
              <div class="input-field">
                  <textarea id="supportMessage" name="report" class="materialize-textarea" required></textarea>
                  <label for="supportMessage">Your Message <span style="color: red">*</span></label>
              </div>
              <div class="input-field">
                  <label id="supportFileLabel">Attach a File <span style="color: red">*</span></label>
                  <input type="file" id="supportFile" name="file" required />
              </div>
          </div>
          <div class="modal-footer">
              <button type="submit" class="btn btn-custom waves-effect waves-light">Submit</button>
              <a href="javascript:void(0)" class="modal-close btn waves-effect waves-light">Close</a>
          </div>
      </form>
  </div>

      <!-- Request Received Popup -->
      <div id="requestReceivedPopup" class="request-received-popup">
        <h5>Request Received!</h5>
        <p>
          Thank you for your support request. We will get back to you shortly.
        </p>
      </div>
      <div class="container center-align" style="margin-top: 40px">
        <p class="grey-text">
          If you don't know how to fill in the fields, check this site for an
          explanation:
          <a
            href="https://www.youtube.com/watch?v=Y-9htzEk0xA"
            target="_blank"
            class="orange-text"
            >Click here</a
          >
        </p>
      </div>
    </main>

    <!-- Load jQuery and Materialize JavaScript -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
      $(document).ready(function () {
          $(".modal").modal();
          $(".tooltipped").tooltip();
          $('#supportForm').on('submit', submitSupportRequest);
          showPage(1);

  
          // Add click handlers for the navigation buttons
          $("a[href^='#page']").click(function(e) {
              e.preventDefault();
              var pageNumber = $(this).attr('href').replace('#page', '');
              showPage(pageNumber);
          });
  
          // Ensure labels don't overlap filled content
          $('.materialize-textarea').each(function() {
              if ($(this).val()) {
                  $(this).next('label').addClass('active');
              }
          });
  
          // Initialize Materialize textareas
          M.textareaAutoResize($('.materialize-textarea'));
      });
  
      function showPage(pageNumber) {
          $(".page").hide();
          $("#page" + pageNumber).show();
      }
  
      function saveField(field) {
          var value = $('#' + field).val();
          var csrftoken = $('[name=csrfmiddlewaretoken]').val();
          $.ajax({
              url: '{% url "srsnew" %}',  // Make sure this URL is correct
              type: 'POST',
              headers: {'X-CSRFToken': csrftoken},
              data: {
                  field: field,
                  value: value
              },
              success: function(response) {
                  if(response.status === 'success') {
                      M.toast({html: 'Saved successfully!', classes: 'rounded'});
                  } else {
                      M.toast({html: 'Error: ' + response.message, classes: 'rounded red'});
                  }
              },
              error: function() {
                  M.toast({html: 'An error occurred', classes: 'rounded red'});
              }
          });
      }
  
      function openSupportModal() {
          $("#supportModal").modal("open");
      }
  
      function closeSupportModal() {
          $("#supportModal").modal("close");
      }
  
      function submitSupportRequest() {
          var name = $("#supportName").val();
          var email = $("#supportEmail").val();
          var message = $("#supportMessage").val();
          var file = $("#supportFile").val();
  
          console.log("Support Request Submitted:", { name, email, message, file });
  
          // Clear the input fields
          $("#supportName").val("");
          $("#supportEmail").val("");
          $("#supportMessage").val("");
          $("#supportFile").val("");
  
          // Close the support modal
          closeSupportModal();
  
          // Show request received popup
          $("#requestReceivedPopup").css({
              visibility: "visible",
              opacity: "1",
          });
  
          // Set a timeout to automatically hide the popup after 3 seconds
          setTimeout(closeRequestReceived, 3000);
      }
  
      function closeRequestReceived() {
          $("#requestReceivedPopup").css({
              visibility: "hidden",
              opacity: "0",
          });
      }

      function submitSupportRequest(event) {
    event.preventDefault();

    var form = $('#supportForm')[0];
    var formData = new FormData(form);

    $.ajax({
        url: '{% url "support_request" %}',  // We'll create this URL
        type: 'POST',
        data: formData,
        processData: false,
        contentType: false,
        success: function(response) {
            if(response.status === 'success') {
                M.toast({html: 'Support request submitted successfully!', classes: 'rounded green'});
                closeSupportModal();
                showRequestReceivedPopup();
            } else {
                M.toast({html: 'Error: ' + response.message, classes: 'rounded red'});
            }
        },
        error: function() {
            M.toast({html: 'An error occurred while submitting the request', classes: 'rounded red'});
        }
    });
}
function showRequestReceivedPopup() {
    $("#requestReceivedPopup").css({
        visibility: "visible",
        opacity: "1",
    });
    setTimeout(closeRequestReceived, 3000);
}
  </script>
  </body>
</html>
